<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Poker Stack Logger v'25/12/29</title>

<style>
body{
  font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;
  margin:12px;
  background:#fff;
  color:#111;
}
h1{font-size:16px;margin:0 0 10px}
.card{
  border:1px solid #ddd;
  border-radius:14px;
  padding:12px;
  margin-bottom:12px;
}
label{font-size:12px;font-weight:700}
input,select,button{
  width:100%;
  padding:10px;
  font-size:16px;
  border-radius:10px;
  border:1px solid #ccc;
}
button{font-weight:900}
.big{font-size:28px;font-weight:900}
.hint{font-size:12px;color:#666;margin-top:4px}
.err{color:#c00;font-weight:900;font-size:12px}

table{
  border-collapse:collapse;
  min-width:640px;
  width:100%;
}
th,td{
  border:1px solid #ddd;
  padding:6px;
  text-align:center;
  font-weight:700;
}
th.sticky{
  position:sticky;
  left:0;
  background:#fff;
  z-index:2;
}
td.hl{background:rgba(0,255,160,.35)}
td.dark{background:#f2f2f2}

.toast{
  position:fixed;
  bottom:20px;
  left:50%;
  transform:translateX(-50%);
  background:#111;
  color:#fff;
  padding:10px 14px;
  border-radius:999px;
  font-size:13px;
  font-weight:900;
  opacity:0;
  transition:.2s;
}
.toast.show{opacity:1}
</style>
</head>

<body>

<h1>Poker Stack Logger <span style="color:#666;font-size:12px">v'25/12/29</span></h1>

<div class="card">
  <label>Chips</label>
  <input id="chips" type="number">
  <div id="chipErr" class="err"></div>

  <label style="margin-top:8px">Initial</label>
  <input id="initial" type="number" value="10000">

  <label style="margin-top:8px">飛んだ回数</label>
  <input id="busted" type="number" value="0">

  <label style="margin-top:8px">SB / BB / Ante</label>
  <div style="display:flex;gap:6px">
    <input id="sb" type="number" value="50">
    <input id="bb" type="number" value="100">
    <input id="ante" type="number" value="0">
  </div>

  <label style="margin-top:8px">後ろの人数</label>
  <input id="behind" type="number" value="7">

  <div class="big" id="powerView" style="margin-top:10px">Power：-</div>
</div>

<div class="card">
  <h2 style="font-size:14px;margin:0 0 6px">パワーナンバー表</h2>
  <div class="hint">Power以上のセルをハイライト</div>
  <div style="overflow:auto;margin-top:8px">
    <table id="powerTable"></table>
  </div>
</div>

<div class="toast" id="toast"></div>

<script>
const RANKS=["A","K","Q","J","T","9","8","7","6","5","4","3","2"];

/* ==== CSV完全反映（AI=80） ==== */
const SCORE={
A:{A:80,K:80,Q:80,J:80,T:80,"9":50,"8":37,"7":32,"6":28,"5":31,"4":27,"3":26,"2":24},
K:{A:80,K:80,Q:80,J:75,T:66,"9":44,"8":17,"7":15,"6":14,"5":13,"4":11,"3":10,"2":9},
Q:{A:80,K:48,Q:80,J:85,T:58,"9":38,"8":16,"7":11,"6":10,"5":8,"4":8,"3":8,"2":8},
J:{A:50,K:31,Q:26,J:80,T:58,"9":39,"8":21,"7":12,"6":7,"5":7,"4":7,"3":7,"2":5},
T:{A:36,K:19,Q:17,J:22,T:80,"9":43,"8":26,"7":15,"6":10,"5":9,"4":7,"3":5,"2":4},
"9":{A:27,K:12,Q:9,J:9,T:11,"9":80,"8":31,"7":17,"6":10,"5":9,"4":3,"3":0,"2":0},
"8":{A:24,K:10,Q:8,J:8,T:10,"9":10,"8":66,"7":19,"6":15,"5":10,"4":5,"3":0,"2":0},
"7":{A:22,K:9,Q:6,J:5,T:6,"9":7,"8":10,"7":58,"6":15,"5":10,"4":9,"3":0,"2":0},
"6":{A:18,K:9,Q:6,J:4,T:3,"9":3,"8":4,"7":7,"6":51,"5":11,"4":10,"3":4,"2":0},
"5":{A:21,K:9,Q:6,J:4,T:0,"9":0,"8":0,"7":0,"6":0,"5":44,"4":11,"3":8,"2":0},
"4":{A:18,K:8,Q:5,J:3,T:0,"9":0,"8":0,"7":0,"6":0,"5":0,"4":39,"3":6,"2":0},
"3":{A:16,K:8,Q:5,J:3,T:0,"9":0,"8":0,"7":0,"6":0,"5":0,"4":0,"3":33,"2":0},
"2":{A:15,K:7,Q:4,J:3,T:0,"9":0,"8":0,"7":0,"6":0,"5":0,"4":0,"3":0,"2":28}
};

const el=id=>document.getElementById(id);
const toast=msg=>{
  const t=el("toast");
  t.textContent=msg;
  t.classList.add("show");
  setTimeout(()=>t.classList.remove("show"),1500);
};

function render(){
  const chips=Number(el("chips").value);
  const ini=Number(el("initial").value)||0;
  const b=Number(el("busted").value)||0;
  const sb=Number(el("sb").value)||0;
  const bb=Number(el("bb").value)||0;
  const ante=Number(el("ante").value)||0;
  const behind=Number(el("behind").value)||0;

  const err=el("chipErr");
  if(Number.isFinite(chips)&&chips<=0){
    err.textContent="Chipsが0以下です。飛んだ場合は飛んだ回数＋1してください。";
    toast("Chipsが0以下です");
  }else err.textContent="";

  const m=(sb+bb+ante)>0?chips/(sb+bb+ante):NaN;
  const power=Number.isFinite(m)?m*behind:NaN;
  el("powerView").textContent=Number.isFinite(power)?`Power：${power.toFixed(1)}`:"Power：-";

  const tbl=el("powerTable");
  let html="<tr><th class='sticky'></th>";
  RANKS.forEach(r=>html+=`<th>${r}</th>`);
  html+="</tr>";

  for(const r of RANKS){
    html+=`<tr><th class="sticky">${r}</th>`;
    for(const c of RANKS){
      const v=SCORE[r][c]||0;
      const hl=Number.isFinite(power)&&v>=power;
      const dark=v<3;
      html+=`<td class="${hl?"hl":dark?"dark":""}">${v?v:""}</td>`;
    }
    html+="</tr>";
  }
  tbl.innerHTML=html;
}

["chips","initial","busted","sb","bb","ante","behind"]
.forEach(id=>el(id).addEventListener("input",render));

render();
</script>

</body>
</html>
